‚+
ED:\TI\git\v2\e-Estoque-API\e-Estoque-API\e-Estoque-API.API\Program.cs
var 
builder 
= 
WebApplication 
. 
CreateBuilder *
(* +
args+ /
)/ 0
;0 1
builder		 
.		 
Configuration		 
.

 
SetBasePath

 
(

 
builder

 
.

 
Environment

 $
.

$ %
ContentRootPath

% 4
)

4 5
. 
AddJsonFile 
( 
$str #
,# $
true% )
,) *
true+ /
)/ 0
. 
AddJsonFile 
( 
$" 
$str 
{  
builder  '
.' (
Environment( 3
.3 4
EnvironmentName4 C
}C D
$strD I
"I J
,J K
trueL P
,P Q
trueR V
)V W
. #
AddEnvironmentVariables 
( 
) 
; 
builder 
. 
Services 
. 
AddMemoryCache 
(  
)  !
;! "
builder 
. 
Services 
. 
	Configure 
< 
ApiBehaviorOptions -
>- .
(. /
options/ 6
=>7 9
{ 
options 
. +
SuppressModelStateInvalidFilter +
=, -
true. 2
;2 3
} 
) 
; 
builder 
. 
Services 
. 
AddCorsConfig 
( 
)  
;  !
builder 
. 
Services 
. 
AddDbContextConfig #
(# $
builder$ +
.+ ,
Configuration, 9
)9 :
;: ;
builder 
. 
Services 
. 
ResolveDependencies $
($ %
)% &
;& '
builder 
. 
Services 
. 
AddMessageBus 
( 
builder &
.& '
Configuration' 4
)4 5
;5 6
builder 
. 
Services 
. "
AddApplicationServices '
(' (
)( )
;) *
builder 
. 
Services 
. 
AddControllers 
(  
)  !
;! "
builder 
. 
Services 
. #
AddEndpointsApiExplorer (
(( )
)) *
;* +
builder 
. 
Services 
. 
AddSwaggerConfig !
(! "
)" #
;# $
builder   
.   
Services   
.   
AddSwaggerGen   
(   
)    
;    !
builder!! 
.!! 
Services!! 
.!! 
AddKeycloakConfig!! "
(!!" #
builder!!# *
.!!* +
Configuration!!+ 8
)!!8 9
;!!9 :
builder## 
.## 
Services## 
.## 
AddObservability## !
(##! "
$str##" -
,##- .
builder##/ 6
.##6 7
Configuration##7 D
)##D E
;##E F
var%% 
app%% 
=%% 	
builder%%
 
.%% 
Build%% 
(%% 
)%% 
;%% 
app'' 
.'' 
MapObservability'' 
('' 
)'' 
;'' 
if++ 
(++ 
app++ 
.++ 
Environment++ 
.++ 
IsDevelopment++ !
(++! "
)++" #
)++# $
{,, 
app.. 
... %
UseDeveloperExceptionPage.. !
(..! "
).." #
;..# $
}// 
else00 
{11 
app33 
.33 
UseHsts33 
(33 
)33 
;33 
}44 
app66 
.66 
UseMiddleware66 
<66 
ExceptionMiddleware66 %
>66% &
(66& '
)66' (
;66( )
app88 
.88 
UseExceptionHandler88 
(88 
options88 
=>88  "
{88# $
}88% &
)88& '
;88' (
app99 
.99 

UseRouting99 
(99 
)99 
;99 
app;; 
.;; 
UseHttpsRedirection;; 
(;; 
);; 
;;; 
app<< 
.<< 
UseAuthentication<< 
(<< 
)<< 
;<< 
app== 
.== 
UseAuthorization== 
(== 
)== 
;== 
app>> 
.>> 
UseHealthChecks>> 
(>> 
$str>> 
)>> 
;>> 
app?? 
.?? 
UseStaticFiles?? 
(?? 
)?? 
;?? 
appAA 
.AA 
MapControllersAA 
(AA 
)AA 
;AA 
appBB 
.BB 
UseSwaggerConfigBB 
(BB 
)BB 
;BB 
appDD 
.DD 
RunDD 
(DD 
)DD 	
;DD	 
—
\D:\TI\git\v2\e-Estoque-API\e-Estoque-API\e-Estoque-API.API\Extensions\ExceptionMiddleware.cs
	namespace 	
e_Estoque_API
 
. 
API 
. 

Extensions &
;& '
public 
class 
ExceptionMiddleware  
{ 
private		 
readonly		 
RequestDelegate		 $
_next		% *
;		* +
private

 
readonly

 
ILogger

 
<

 
ExceptionMiddleware

 0
>

0 1
_log

2 6
;

6 7
public 

ExceptionMiddleware 
( 
RequestDelegate .
next/ 3
,3 4
ILogger5 <
<< =
ExceptionMiddleware= P
>P Q
logR U
)U V
{ 
_log 
= 
log 
; 
_next 
= 
next 
; 
} 
public 

async 
Task 
InvokeAsync !
(! "
HttpContext" -
httpContext. 9
)9 :
{ 
try 
{ 	
await 
_next 
( 
httpContext #
)# $
;$ %
} 	
catch 
( 
	Exception 
ex 
) 
{ 	
_log 
. 
LogError 
( 
ex 
. 
Message $
)$ %
;% &
await  
HandleExceptionAsync &
(& '
httpContext' 2
,2 3
ex4 6
)6 7
;7 8
} 	
} 
private 
static 
Task  
HandleExceptionAsync ,
(, -
HttpContext- 8
context9 @
,@ A
	ExceptionB K
	exceptionL U
)U V
{   
HttpStatusCode!! 
code!! 
=!! 
HttpStatusCode!! ,
.!!, -
InternalServerError!!- @
;!!@ A
if## 

(## 
	exception## 
is## 
NotFoundException## *
)##* +
code##, 0
=##1 2
HttpStatusCode##3 A
.##A B
NotFound##B J
;##J K
if$$ 

($$ 
	exception$$ 
is$$ 
ValidationException$$ ,
)$$, -
code$$. 2
=$$3 4
HttpStatusCode$$5 C
.$$C D 
UnprocessableContent$$D X
;$$X Y
string&& 
result&& 
=&& 
JsonSerializer&& &
.&&& '
	Serialize&&' 0
(&&0 1
new&&1 4
{&&5 6
error&&7 <
=&&= >
	exception&&? H
.&&H I
Message&&I P
}&&Q R
)&&R S
;&&S T
context(( 
.(( 
Response(( 
.(( 
ContentType(( $
=((% &
$str((' 9
;((9 :
context)) 
.)) 
Response)) 
.)) 

StatusCode)) #
=))$ %
())& '
int))' *
)))* +
code))+ /
;))/ 0
return++ 
context++ 
.++ 
Response++ 
.++  

WriteAsync++  *
(++* +
result+++ 1
)++1 2
;++2 3
},, 
}-- þ7
_D:\TI\git\v2\e-Estoque-API\e-Estoque-API\e-Estoque-API.API\Extensions\CustomExceptionHandler.cs
	namespace 	
e_Estoque_API
 
. 
API 
. 

Extensions &
;& '
public 
class "
CustomExceptionHandler #
:$ %
IExceptionHandler& 7
{		 
private

 
readonly

 

Dictionary

 
<

  
Type

  $
,

$ %
Func

& *
<

* +
HttpContext

+ 6
,

6 7
	Exception

8 A
,

A B
Task

C G
>

G H
>

H I
_exceptionHandlers

J \
;

\ ]
public 
"
CustomExceptionHandler !
(! "
)" #
{ 
_exceptionHandlers 
= 
new  
(  !
)! "
{ 
{ 
typeof 
( 
ValidationException ,
), -
,- .%
HandleValidationException/ H
}I J
,J K
{ 
typeof 
( 
NotFoundException *
)* +
,+ ,#
HandleNotFoundException- D
}E F
,F G
{ 
typeof 
( '
UnauthorizedAccessException 4
)4 5
,5 6-
!HandleUnauthorizedAccessException7 X
}Y Z
,Z [
{ 
typeof 
( $
ForbiddenAccessException 1
)1 2
,2 3*
HandleForbiddenAccessException4 R
}S T
,T U
} 
; 
} 
public 

async 
	ValueTask 
< 
bool 
>  
TryHandleAsync! /
(/ 0
HttpContext0 ;
httpContext< G
,G H
	ExceptionI R
	exceptionS \
,\ ]
CancellationToken^ o
cancellationToken	p 
)
 ‚
{ 
var 
exceptionType 
= 
	exception %
.% &
GetType& -
(- .
). /
;/ 0
if 

( 
_exceptionHandlers 
. 
TryGetValue *
(* +
exceptionType+ 8
,8 9
out: =
var> A
valB E
)E F
)F G
{ 	
await 
_exceptionHandlers $
[$ %
exceptionType% 2
]2 3
.3 4
Invoke4 :
(: ;
httpContext; F
,F G
	exceptionH Q
)Q R
;R S
return 
true 
; 
}   	
return"" 
false"" 
;"" 
}## 
private%% 
async%% 
Task%% %
HandleValidationException%% 0
(%%0 1
HttpContext%%1 <
httpContext%%= H
,%%H I
	Exception%%J S
ex%%T V
)%%V W
{&& 
var'' 
	exception'' 
='' 
('' 
ValidationException'' ,
)'', -
ex''- /
;''/ 0
httpContext)) 
.)) 
Response)) 
.)) 

StatusCode)) '
=))( )
StatusCodes))* 5
.))5 6
Status400BadRequest))6 I
;))I J
await++ 
httpContext++ 
.++ 
Response++ "
.++" #
WriteAsJsonAsync++# 3
(++3 4
new++4 7$
ValidationProblemDetails++8 P
(++P Q
	exception++Q Z
.++Z [
Errors++[ a
)++a b
{,, 	
Status-- 
=-- 
StatusCodes--  
.--  !
Status400BadRequest--! 4
,--4 5
Type.. 
=.. 
$str.. F
}// 	
)//	 

;//
 
}00 
private22 
async22 
Task22 #
HandleNotFoundException22 .
(22. /
HttpContext22/ :
httpContext22; F
,22F G
	Exception22H Q
ex22R T
)22T U
{33 
var44 
	exception44 
=44 
(44 
NotFoundException44 *
)44* +
ex44+ -
;44- .
httpContext66 
.66 
Response66 
.66 

StatusCode66 '
=66( )
StatusCodes66* 5
.665 6
Status404NotFound666 G
;66G H
await88 
httpContext88 
.88 
Response88 "
.88" #
WriteAsJsonAsync88# 3
(883 4
new884 7
ProblemDetails888 F
(88F G
)88G H
{99 	
Status:: 
=:: 
StatusCodes::  
.::  !
Status404NotFound::! 2
,::2 3
Type;; 
=;; 
$str;; F
,;;F G
Title<< 
=<< 
$str<< ;
,<<; <
Detail== 
=== 
	exception== 
.== 
Message== &
}>> 	
)>>	 

;>>
 
}?? 
privateAA 
asyncAA 
TaskAA -
!HandleUnauthorizedAccessExceptionAA 8
(AA8 9
HttpContextAA9 D
httpContextAAE P
,AAP Q
	ExceptionAAR [
exAA\ ^
)AA^ _
{BB 
httpContextCC 
.CC 
ResponseCC 
.CC 

StatusCodeCC '
=CC( )
StatusCodesCC* 5
.CC5 6!
Status401UnauthorizedCC6 K
;CCK L
awaitEE 
httpContextEE 
.EE 
ResponseEE "
.EE" #
WriteAsJsonAsyncEE# 3
(EE3 4
newEE4 7
ProblemDetailsEE8 F
{FF 	
StatusGG 
=GG 
StatusCodesGG  
.GG  !!
Status401UnauthorizedGG! 6
,GG6 7
TitleHH 
=HH 
$strHH "
,HH" #
TypeII 
=II 
$strII D
}JJ 	
)JJ	 

;JJ
 
}KK 
privateMM 
asyncMM 
TaskMM *
HandleForbiddenAccessExceptionMM 5
(MM5 6
HttpContextMM6 A
httpContextMMB M
,MMM N
	ExceptionMMO X
exMMY [
)MM[ \
{NN 
httpContextOO 
.OO 
ResponseOO 
.OO 

StatusCodeOO '
=OO( )
StatusCodesOO* 5
.OO5 6
Status403ForbiddenOO6 H
;OOH I
awaitQQ 
httpContextQQ 
.QQ 
ResponseQQ "
.QQ" #
WriteAsJsonAsyncQQ# 3
(QQ3 4
newQQ4 7
ProblemDetailsQQ8 F
{RR 	
StatusSS 
=SS 
StatusCodesSS  
.SS  !
Status403ForbiddenSS! 3
,SS3 4
TitleTT 
=TT 
$strTT 
,TT  
TypeUU 
=UU 
$strUU F
}VV 	
)VV	 

;VV
 
}WW 
}XX à*
WD:\TI\git\v2\e-Estoque-API\e-Estoque-API\e-Estoque-API.API\Controllers\TaxController.cs
	namespace 	
e_Estoque_API
 
. 
API 
. 
Controllers '
;' (
[		 
	Authorize		 

]		
 
[

 
Route

 
(

 
$str

 
)

 
]

 
[ 
ApiController 
] 
public 
class 
TaxController 
: 
MainController +
{ 
private 
readonly 
	IMediator 
	_mediator (
;( )
public 

TaxController 
( 
	IMediator "
mediator# +
)+ ,
{ 
	_mediator 
= 
mediator 
; 
} 
[ 
HttpGet 
] 
public 

async 
Task 
< 
IActionResult #
># $
Get% (
(( )
[) *
	FromQuery* 3
]3 4
SearchTaxQuery5 C
queryD I
)I J
{ 
var 
result 
= 
await 
	_mediator $
.$ %
Send% )
() *
query* /
)/ 0
;0 1
if 

( 
result 
== 
null 
) 
return 
CustomResponse !
(! "
false" '
,' (
null) -
)- .
;. /
return 
CustomResponse 
( 
true "
," #
result$ *
)* +
;+ ,
} 
[   
HttpGet   
(   
$str   
)   
]   
public!! 

async!! 
Task!! 
<!! 
IActionResult!! #
>!!# $
Get!!% (
(!!( )
Guid!!) -
id!!. 0
)!!0 1
{"" 
var## 
query## 
=## 
new## 
GetByIdTaxQuery## '
(##' (
id##( *
)##* +
;##+ ,
var%% 
result%% 
=%% 
await%% 
	_mediator%% $
.%%$ %
Send%%% )
(%%) *
query%%* /
)%%/ 0
;%%0 1
if'' 

('' 
result'' 
=='' 
null'' 
)'' 
return(( 
CustomResponse(( !
(((! "
false((" '
,((' (
null(() -
)((- .
;((. /
return** 
CustomResponse** 
(** 
true** "
,**" #
result**$ *
)*** +
;**+ ,
}++ 
[-- 
	Authorize-- 
(-- 
Roles-- 
=-- 
$str-- 
)--  
]--  !
[.. 
HttpPost.. 
].. 
public// 

async// 
Task// 
<// 
IActionResult// #
>//# $
Post//% )
(//) *
[//* +
FromBody//+ 3
]//3 4
CreateTaxCommand//5 E
command//F M
)//M N
{00 
var11 
id11 
=11 
await11 
	_mediator11  
.11  !
Send11! %
(11% &
command11& -
)11- .
;11. /
return33 
await33 
Get33 
(33 
id33 
)33 
;33 
}44 
[66 
	Authorize66 
(66 
Roles66 
=66 
$str66 
)66  
]66  !
[77 
HttpPut77 
(77 
$str77 
)77 
]77 
public88 

async88 
Task88 
<88 
IActionResult88 #
>88# $
Put88% (
(88( )
[88) *
FromBody88* 2
]882 3
UpdateTaxCommand884 D
command88E L
)88L M
{99 
var:: 
result:: 
=:: 
await:: 
	_mediator:: $
.::$ %
Send::% )
(::) *
command::* 1
)::1 2
;::2 3
return<< 
await<< 
Get<< 
(<< 
result<< 
)<<  
;<<  !
}== 
[?? 
	Authorize?? 
(?? 
Roles?? 
=?? 
$str?? 
)??  
]??  !
[@@ 

HttpDelete@@ 
(@@ 
$str@@ 
)@@ 
]@@ 
publicAA 

asyncAA 
TaskAA 
<AA 
IActionResultAA #
>AA# $
DeleteAA% +
(AA+ ,
GuidAA, 0
idAA1 3
)AA3 4
{BB 
varCC 
commandCC 
=CC 
newCC 
DeleteTaxCommandCC *
(CC* +
idCC+ -
)CC- .
;CC. /
varEE 
resultEE 
=EE 
awaitEE 
	_mediatorEE $
.EE$ %
SendEE% )
(EE) *
commandEE* 1
)EE1 2
;EE2 3
returnGG 
CustomResponseGG 
(GG 
trueGG "
,GG" #
resultGG$ *
)GG* +
;GG+ ,
}HH 
}II €+
[D:\TI\git\v2\e-Estoque-API\e-Estoque-API\e-Estoque-API.API\Controllers\ProductController.cs
	namespace 	
e_Estoque_API
 
. 
API 
. 
Controllers '
;' (
[		 
	Authorize		 

]		
 
[

 
Route

 
(

 
$str

 
)

 
]

 
[ 
ApiController 
] 
public 
class 
ProductController 
:  
MainController! /
{ 
private 
readonly 
	IMediator 
	_mediator (
;( )
public 

ProductController 
( 
	IMediator &
mediator' /
)/ 0
{ 
	_mediator 
= 
mediator 
; 
} 
[ 
HttpGet 
] 
public 

async 
Task 
< 
IActionResult #
># $
Get% (
(( )
[) *
	FromQuery* 3
]3 4
SearchProductQuery5 G
queryH M
)M N
{ 
var 
result 
= 
await 
	_mediator $
.$ %
Send% )
() *
query* /
)/ 0
;0 1
if 

( 
result 
== 
null 
) 
return 
CustomResponse !
(! "
false" '
,' (
null) -
)- .
;. /
return 
CustomResponse 
( 
true "
," #
result$ *
)* +
;+ ,
} 
[   
HttpGet   
(   
$str   
)   
]   
public!! 

async!! 
Task!! 
<!! 
IActionResult!! #
>!!# $
Get!!% (
(!!( )
Guid!!) -
id!!. 0
)!!0 1
{"" 
var## 
query## 
=## 
new## 
GetByIdProductQuery## +
(##+ ,
id##, .
)##. /
;##/ 0
var%% 
result%% 
=%% 
await%% 
	_mediator%% $
.%%$ %
Send%%% )
(%%) *
query%%* /
)%%/ 0
;%%0 1
if'' 

('' 
result'' 
=='' 
null'' 
)'' 
return(( 
CustomResponse(( !
(((! "
false((" '
,((' (
null(() -
)((- .
;((. /
return** 
CustomResponse** 
(** 
true** "
,**" #
result**$ *
)*** +
;**+ ,
}++ 
[-- 
	Authorize-- 
(-- 
Roles-- 
=-- 
$str-- 
)--  
]--  !
[.. 
HttpPost.. 
].. 
public// 

async// 
Task// 
<// 
IActionResult// #
>//# $
Post//% )
(//) *
[//* +
FromBody//+ 3
]//3 4 
CreateProductCommand//5 I
command//J Q
)//Q R
{00 
var11 
id11 
=11 
await11 
	_mediator11  
.11  !
Send11! %
(11% &
command11& -
)11- .
;11. /
return33 
await33 
Get33 
(33 
id33 
)33 
;33 
}44 
[66 
	Authorize66 
(66 
Roles66 
=66 
$str66 
)66  
]66  !
[77 
HttpPut77 
(77 
$str77 
)77 
]77 
public88 

async88 
Task88 
<88 
IActionResult88 #
>88# $
Put88% (
(88( )
[88) *
FromBody88* 2
]882 3 
UpdateProductCommand884 H
command88I P
)88P Q
{99 
var:: 
result:: 
=:: 
await:: 
	_mediator:: $
.::$ %
Send::% )
(::) *
command::* 1
)::1 2
;::2 3
return<< 
await<< 
Get<< 
(<< 
result<< 
)<<  
;<<  !
}== 
[?? 
	Authorize?? 
(?? 
Roles?? 
=?? 
$str?? 
)??  
]??  !
[@@ 

HttpDelete@@ 
(@@ 
$str@@ 
)@@ 
]@@ 
publicAA 

asyncAA 
TaskAA 
<AA 
IActionResultAA #
>AA# $
DeleteAA% +
(AA+ ,
GuidAA, 0
idAA1 3
)AA3 4
{BB 
varCC 
commandCC 
=CC 
newCC  
DeleteProductCommandCC .
(CC. /
idCC/ 1
)CC1 2
;CC2 3
varEE 
resultEE 
=EE 
awaitEE 
	_mediatorEE $
.EE$ %
SendEE% )
(EE) *
commandEE* 1
)EE1 2
;EE2 3
returnGG 
CustomResponseGG 
(GG 
trueGG "
,GG" #
resultGG$ *
)GG* +
;GG+ ,
}HH 
}II é
XD:\TI\git\v2\e-Estoque-API\e-Estoque-API\e-Estoque-API.API\Controllers\MainController.cs
	namespace 	
e_Estoque_API
 
. 
API 
. 
Controllers '
;' (
[ 
ApiController 
] 
public 
class 
MainController 
: 
ControllerBase ,
{ 
	protected 
IActionResult 
CustomResponse *
(* +
bool+ /
success0 7
,7 8
object9 ?
?? @
resultA G
=H I
nullJ N
)N O
{		 
if

 

(

 
success

 
)

 
{ 	
return 
Ok 
( 
result 
) 
; 
} 	
return 

BadRequest 
( 
result  
)  !
;! "
} 
} Ž+
]D:\TI\git\v2\e-Estoque-API\e-Estoque-API\e-Estoque-API.API\Controllers\InventoryController.cs
	namespace 	
e_Estoque_API
 
. 
API 
. 
Controllers '
;' (
[

 
	Authorize

 

]


 
[ 
Route 
( 
$str 
) 
] 
[ 
ApiController 
] 
public 
class 
InventoryController  
:! "
MainController# 1
{ 
private 
readonly 
	IMediator 
	_mediator (
;( )
public 

InventoryController 
( 
	IMediator (
mediator) 1
)1 2
{ 
	_mediator 
= 
mediator 
; 
} 
[ 
HttpGet 
] 
public 

async 
Task 
< 
IActionResult #
># $
Get% (
(( )
[) *
	FromQuery* 3
]3 4 
SearchInventoryQuery5 I
queryJ O
)O P
{ 
var 
result 
= 
await 
	_mediator $
.$ %
Send% )
() *
query* /
)/ 0
;0 1
if 

( 
result 
== 
null 
) 
return 
CustomResponse !
(! "
false" '
,' (
null) -
)- .
;. /
return 
CustomResponse 
( 
true "
," #
result$ *
)* +
;+ ,
} 
[!! 
HttpGet!! 
(!! 
$str!! 
)!! 
]!! 
public"" 

async"" 
Task"" 
<"" 
IActionResult"" #
>""# $
Get""% (
(""( )
Guid"") -
id"". 0
)""0 1
{## 
var$$ 
query$$ 
=$$ 
new$$ 
GetByIdProductQuery$$ +
($$+ ,
id$$, .
)$$. /
;$$/ 0
var&& 
result&& 
=&& 
await&& 
	_mediator&& $
.&&$ %
Send&&% )
(&&) *
query&&* /
)&&/ 0
;&&0 1
if(( 

((( 
result(( 
==(( 
null(( 
)(( 
return)) 
CustomResponse)) !
())! "
false))" '
,))' (
null))) -
)))- .
;)). /
return++ 
CustomResponse++ 
(++ 
true++ "
,++" #
result++$ *
)++* +
;+++ ,
},, 
[.. 
	Authorize.. 
(.. 
Roles.. 
=.. 
$str.. 
)..  
]..  !
[// 
HttpPost// 
]// 
public00 

async00 
Task00 
<00 
IActionResult00 #
>00# $
Post00% )
(00) *
[00* +
FromBody00+ 3
]003 4"
CreateInventoryCommand005 K
command00L S
)00S T
{11 
var22 
id22 
=22 
await22 
	_mediator22  
.22  !
Send22! %
(22% &
command22& -
)22- .
;22. /
return44 
await44 
Get44 
(44 
id44 
)44 
;44 
}55 
[77 
	Authorize77 
(77 
Roles77 
=77 
$str77 
)77  
]77  !
[88 
HttpPut88 
(88 
$str88 
)88 
]88 
public99 

async99 
Task99 
<99 
IActionResult99 #
>99# $
Put99% (
(99( )
[99) *
FromBody99* 2
]992 3"
UpdateInventoryCommand994 J
command99K R
)99R S
{:: 
var;; 
result;; 
=;; 
await;; 
	_mediator;; $
.;;$ %
Send;;% )
(;;) *
command;;* 1
);;1 2
;;;2 3
return== 
await== 
Get== 
(== 
result== 
)==  
;==  !
}>> 
[@@ 
	Authorize@@ 
(@@ 
Roles@@ 
=@@ 
$str@@ 
)@@  
]@@  !
[AA 

HttpDeleteAA 
(AA 
$strAA 
)AA 
]AA 
publicBB 

asyncBB 
TaskBB 
<BB 
IActionResultBB #
>BB# $
DeleteBB% +
(BB+ ,
GuidBB, 0
idBB1 3
)BB3 4
{CC 
varDD 
commandDD 
=DD 
newDD "
DeleteInventoryCommandDD 0
(DD0 1
idDD1 3
)DD3 4
;DD4 5
varFF 
resultFF 
=FF 
awaitFF 
	_mediatorFF $
.FF$ %
SendFF% )
(FF) *
commandFF* 1
)FF1 2
;FF2 3
returnHH 
CustomResponseHH 
(HH 
trueHH "
,HH" #
resultHH$ *
)HH* +
;HH+ ,
}II 
}JJ ˆ+
\D:\TI\git\v2\e-Estoque-API\e-Estoque-API\e-Estoque-API.API\Controllers\CustomerController.cs
	namespace 	
e_Estoque_API
 
. 
API 
. 
Controllers '
;' (
[		 
	Authorize		 

]		
 
[

 
Route

 
(

 
$str

 
)

 
]

 
[ 
ApiController 
] 
public 
class 
CustomerController 
:  !
MainController" 0
{ 
private 
readonly 
	IMediator 
	_mediator (
;( )
public 

CustomerController 
( 
	IMediator '
mediator( 0
)0 1
{ 
	_mediator 
= 
mediator 
; 
} 
[ 
HttpGet 
] 
public 

async 
Task 
< 
IActionResult #
># $
Get% (
(( )
[) *
	FromQuery* 3
]3 4
SearchCustomerQuery5 H
queryI N
)N O
{ 
var 
result 
= 
await 
	_mediator $
.$ %
Send% )
() *
query* /
)/ 0
;0 1
if 

( 
result 
== 
null 
) 
return 
CustomResponse !
(! "
false" '
,' (
null) -
)- .
;. /
return 
CustomResponse 
( 
true "
," #
result$ *
)* +
;+ ,
} 
[   
HttpGet   
(   
$str   
)   
]   
public!! 

async!! 
Task!! 
<!! 
IActionResult!! #
>!!# $
Get!!% (
(!!( )
Guid!!) -
id!!. 0
)!!0 1
{"" 
var## 
query## 
=## 
new##  
GetByIdCustomerQuery## ,
(##, -
id##- /
)##/ 0
;##0 1
var%% 
result%% 
=%% 
await%% 
	_mediator%% $
.%%$ %
Send%%% )
(%%) *
query%%* /
)%%/ 0
;%%0 1
if'' 

('' 
result'' 
=='' 
null'' 
)'' 
return(( 
CustomResponse(( !
(((! "
false((" '
,((' (
null(() -
)((- .
;((. /
return** 
CustomResponse** 
(** 
true** "
,**" #
result**$ *
)*** +
;**+ ,
}++ 
[-- 
	Authorize-- 
(-- 
Roles-- 
=-- 
$str-- 
)--  
]--  !
[.. 
HttpPost.. 
].. 
public// 

async// 
Task// 
<// 
IActionResult// #
>//# $
Post//% )
(//) *
[//* +
FromBody//+ 3
]//3 4!
CreateCustomerCommand//5 J
command//K R
)//R S
{00 
var11 
id11 
=11 
await11 
	_mediator11  
.11  !
Send11! %
(11% &
command11& -
)11- .
;11. /
return33 
await33 
Get33 
(33 
id33 
)33 
;33 
}44 
[66 
	Authorize66 
(66 
Roles66 
=66 
$str66 
)66  
]66  !
[77 
HttpPut77 
(77 
$str77 
)77 
]77 
public88 

async88 
Task88 
<88 
IActionResult88 #
>88# $
Put88% (
(88( )
[88) *
FromBody88* 2
]882 3!
UpdateCustomerCommand884 I
command88J Q
)88Q R
{99 
var:: 
result:: 
=:: 
await:: 
	_mediator:: $
.::$ %
Send::% )
(::) *
command::* 1
)::1 2
;::2 3
return<< 
await<< 
Get<< 
(<< 
result<< 
)<<  
;<<  !
}== 
[?? 
	Authorize?? 
(?? 
Roles?? 
=?? 
$str?? 
)??  
]??  !
[@@ 

HttpDelete@@ 
(@@ 
$str@@ 
)@@ 
]@@ 
publicAA 

asyncAA 
TaskAA 
<AA 
IActionResultAA #
>AA# $
DeleteAA% +
(AA+ ,
GuidAA, 0
idAA1 3
)AA3 4
{BB 
varCC 
commandCC 
=CC 
newCC !
DeleteCustomerCommandCC /
(CC/ 0
idCC0 2
)CC2 3
;CC3 4
varEE 
resultEE 
=EE 
awaitEE 
	_mediatorEE $
.EE$ %
SendEE% )
(EE) *
commandEE* 1
)EE1 2
;EE2 3
returnGG 
CustomResponseGG 
(GG 
trueGG "
,GG" #
resultGG$ *
)GG* +
;GG+ ,
}HH 
}II €+
[D:\TI\git\v2\e-Estoque-API\e-Estoque-API\e-Estoque-API.API\Controllers\CompanyController.cs
	namespace 	
e_Estoque_API
 
. 
API 
. 
Controllers '
;' (
[		 
	Authorize		 

]		
 
[

 
Route

 
(

 
$str

 
)

 
]

 
[ 
ApiController 
] 
public 
class 
CompanyController 
:  
MainController! /
{ 
private 
readonly 
	IMediator 
	_mediator (
;( )
public 

CompanyController 
( 
	IMediator &
mediator' /
)/ 0
{ 
	_mediator 
= 
mediator 
; 
} 
[ 
HttpGet 
] 
public 

async 
Task 
< 
IActionResult #
># $
Get% (
(( )
[) *
	FromQuery* 3
]3 4
SearchCompanyQuery5 G
queryH M
)M N
{ 
var 
result 
= 
await 
	_mediator $
.$ %
Send% )
() *
query* /
)/ 0
;0 1
if 

( 
result 
== 
null 
) 
return 
CustomResponse !
(! "
false" '
,' (
null) -
)- .
;. /
return 
CustomResponse 
( 
true "
," #
result$ *
)* +
;+ ,
} 
[   
HttpGet   
(   
$str   
)   
]   
public!! 

async!! 
Task!! 
<!! 
IActionResult!! #
>!!# $
Get!!% (
(!!( )
Guid!!) -
id!!. 0
)!!0 1
{"" 
var## 
query## 
=## 
new## 
GetByIdCompanyQuery## +
(##+ ,
id##, .
)##. /
;##/ 0
var%% 
result%% 
=%% 
await%% 
	_mediator%% $
.%%$ %
Send%%% )
(%%) *
query%%* /
)%%/ 0
;%%0 1
if'' 

('' 
result'' 
=='' 
null'' 
)'' 
return(( 
CustomResponse(( !
(((! "
false((" '
,((' (
null(() -
)((- .
;((. /
return** 
CustomResponse** 
(** 
true** "
,**" #
result**$ *
)*** +
;**+ ,
}++ 
[-- 
	Authorize-- 
(-- 
Roles-- 
=-- 
$str-- 
)--  
]--  !
[.. 
HttpPost.. 
].. 
public// 

async// 
Task// 
<// 
IActionResult// #
>//# $
Post//% )
(//) *
[//* +
FromBody//+ 3
]//3 4 
CreateCompanyCommand//5 I
command//J Q
)//Q R
{00 
var11 
id11 
=11 
await11 
	_mediator11  
.11  !
Send11! %
(11% &
command11& -
)11- .
;11. /
return33 
await33 
Get33 
(33 
id33 
)33 
;33 
}44 
[66 
	Authorize66 
(66 
Roles66 
=66 
$str66 
)66  
]66  !
[77 
HttpPut77 
(77 
$str77 
)77 
]77 
public88 

async88 
Task88 
<88 
IActionResult88 #
>88# $
Put88% (
(88( )
[88) *
FromBody88* 2
]882 3 
UpdateCompanyCommand884 H
command88I P
)88P Q
{99 
var:: 
result:: 
=:: 
await:: 
	_mediator:: $
.::$ %
Send::% )
(::) *
command::* 1
)::1 2
;::2 3
return<< 
await<< 
Get<< 
(<< 
result<< 
)<<  
;<<  !
}== 
[?? 
	Authorize?? 
(?? 
Roles?? 
=?? 
$str?? 
)??  
]??  !
[@@ 

HttpDelete@@ 
(@@ 
$str@@ 
)@@ 
]@@ 
publicAA 

asyncAA 
TaskAA 
<AA 
IActionResultAA #
>AA# $
DeleteAA% +
(AA+ ,
GuidAA, 0
idAA1 3
)AA3 4
{BB 
varCC 
commandCC 
=CC 
newCC  
DeleteCompanyCommandCC .
(CC. /
idCC/ 1
)CC1 2
;CC2 3
varEE 
resultEE 
=EE 
awaitEE 
	_mediatorEE $
.EE$ %
SendEE% )
(EE) *
commandEE* 1
)EE1 2
;EE2 3
returnGG 
CustomResponseGG 
(GG 
trueGG "
,GG" #
resultGG$ *
)GG* +
;GG+ ,
}HH 
}II ˆ+
\D:\TI\git\v2\e-Estoque-API\e-Estoque-API\e-Estoque-API.API\Controllers\CategoryController.cs
	namespace 	
e_Estoque_API
 
. 
API 
. 
Controllers '
;' (
[		 
	Authorize		 

]		
 
[

 
Route

 
(

 
$str

 
)

 
]

 
[ 
ApiController 
] 
public 
class 
CategoryController 
:  !
MainController" 0
{ 
private 
readonly 
	IMediator 
	_mediator (
;( )
public 

CategoryController 
( 
	IMediator '
mediator( 0
)0 1
{ 
	_mediator 
= 
mediator 
; 
} 
[ 
HttpGet 
] 
public 

async 
Task 
< 
IActionResult #
># $
Get% (
(( )
[) *
	FromQuery* 3
]3 4
SearchCategoryQuery5 H
queryI N
)N O
{ 
var 
result 
= 
await 
	_mediator $
.$ %
Send% )
() *
query* /
)/ 0
;0 1
if 

( 
result 
== 
null 
) 
return 
CustomResponse !
(! "
false" '
,' (
null) -
)- .
;. /
return 
CustomResponse 
( 
true "
," #
result$ *
)* +
;+ ,
} 
[   
HttpGet   
(   
$str   
)   
]   
public!! 

async!! 
Task!! 
<!! 
IActionResult!! #
>!!# $
Get!!% (
(!!( )
Guid!!) -
id!!. 0
)!!0 1
{"" 
var## 
query## 
=## 
new##  
GetByIdCategoryQuery## ,
(##, -
id##- /
)##/ 0
;##0 1
var%% 
result%% 
=%% 
await%% 
	_mediator%% $
.%%$ %
Send%%% )
(%%) *
query%%* /
)%%/ 0
;%%0 1
if'' 

('' 
result'' 
=='' 
null'' 
)'' 
return(( 
CustomResponse(( !
(((! "
false((" '
,((' (
null(() -
)((- .
;((. /
return** 
CustomResponse** 
(** 
true** "
,**" #
result**$ *
)*** +
;**+ ,
}++ 
[-- 
	Authorize-- 
(-- 
Roles-- 
=-- 
$str-- 
)--  
]--  !
[.. 
HttpPost.. 
].. 
public// 

async// 
Task// 
<// 
IActionResult// #
>//# $
Post//% )
(//) *
[//* +
FromBody//+ 3
]//3 4!
CreateCategoryCommand//5 J
command//K R
)//R S
{00 
var11 
id11 
=11 
await11 
	_mediator11  
.11  !
Send11! %
(11% &
command11& -
)11- .
;11. /
return33 
await33 
Get33 
(33 
id33 
)33 
;33 
}44 
[66 
	Authorize66 
(66 
Roles66 
=66 
$str66 
)66  
]66  !
[77 
HttpPut77 
(77 
$str77 
)77 
]77 
public88 

async88 
Task88 
<88 
IActionResult88 #
>88# $
Put88% (
(88( )
[88) *
FromBody88* 2
]882 3!
UpdateCategoryCommand884 I
command88J Q
)88Q R
{99 
var:: 
result:: 
=:: 
await:: 
	_mediator:: $
.::$ %
Send::% )
(::) *
command::* 1
)::1 2
;::2 3
return<< 
await<< 
Get<< 
(<< 
result<< 
)<<  
;<<  !
}== 
[?? 
	Authorize?? 
(?? 
Roles?? 
=?? 
$str?? 
)??  
]??  !
[@@ 

HttpDelete@@ 
(@@ 
$str@@ 
)@@ 
]@@ 
publicAA 

asyncAA 
TaskAA 
<AA 
IActionResultAA #
>AA# $
DeleteAA% +
(AA+ ,
GuidAA, 0
idAA1 3
)AA3 4
{BB 
varCC 
commandCC 
=CC 
newCC !
DeleteCategoryCommandCC /
(CC/ 0
idCC0 2
)CC2 3
;CC3 4
varEE 
resultEE 
=EE 
awaitEE 
	_mediatorEE $
.EE$ %
SendEE% )
(EE) *
commandEE* 1
)EE1 2
;EE2 3
returnGG 
CustomResponseGG 
(GG 
trueGG "
,GG" #
resultGG$ *
)GG* +
;GG+ ,
}HH 
}II ™
XD:\TI\git\v2\e-Estoque-API\e-Estoque-API\e-Estoque-API.API\Controllers\AuthController.cs
	namespace 	
e_Estoque_API
 
. 
API 
. 
Controllers '
;' (
[ 
AllowAnonymous 
] 
public		 
class		 
AuthController		 
:		 
MainController		 ,
{

 
private 
readonly 
	IMediator 
	_mediator (
;( )
public 

AuthController 
( 
	IMediator #
mediator$ ,
), -
{ 
	_mediator 
= 
mediator 
; 
} 
[ 
HttpPost 
( 
$str 
) 
] 
public 

async 
Task 
< 
IActionResult #
># $
Register% -
(- .
[. /
FromBody/ 7
]7 8
RegisterUserCommand9 L
commandM T
)T U
{ 
var 
result 
= 
await 
	_mediator $
.$ %
Send% )
() *
command* 1
)1 2
;2 3
if 

( 
result 
== 
null 
) 
return 
CustomResponse !
(! "
false" '
,' (
null) -
)- .
;. /
return 
CustomResponse 
( 
true "
," #
result$ *
)* +
;+ ,
} 
[ 
HttpPost 
( 
$str 
) 
] 
public 

async 
Task 
< 
IActionResult #
># $
Login% *
(* +
[+ ,
FromBody, 4
]4 5
LoginUserCommand6 F
commandG N
)N O
{ 
var   
result   
=   
await   
	_mediator   $
.  $ %
Send  % )
(  ) *
command  * 1
)  1 2
;  2 3
if"" 

("" 
result"" 
=="" 
null"" 
)"" 
return## 
CustomResponse## !
(##! "
false##" '
,##' (
null##) -
)##- .
;##. /
return%% 
CustomResponse%% 
(%% 
true%% "
,%%" #
result%%$ *
)%%* +
;%%+ ,
}&& 
}'' ¥>
YD:\TI\git\v2\e-Estoque-API\e-Estoque-API\e-Estoque-API.API\Configuration\SwaggerConfig.cs
	namespace 	
e_Estoque_API
 
. 
API 
. 
Configuration )
;) *
public		 
static		 
class		 
SwaggerConfig		 !
{

 
public 

static 
IServiceCollection $
AddSwaggerConfig% 5
(5 6
this6 :
IServiceCollection; M
servicesN V
)V W
{ 
services 
. 3
'AddDatabaseDeveloperPageExceptionFilter 8
(8 9
)9 :
;: ;
services 
. "
AddHttpContextAccessor '
(' (
)( )
;) *
services 
. 
AddExceptionHandler $
<$ %"
CustomExceptionHandler% ;
>; <
(< =
)= >
;> ?
services 
. 
	Configure 
< 
ApiBehaviorOptions -
>- .
(. /
options/ 6
=>7 9
options 
. +
SuppressModelStateInvalidFilter 3
=4 5
true6 :
): ;
;; <
services 
. 
AddSwaggerGen 
( 
c  
=>! #
{ 	
c 
. 
OperationFilter 
<  
SwaggerDefaultValues 2
>2 3
(3 4
)4 5
;5 6
c 
. !
AddSecurityDefinition #
(# $
$str$ .
,. /
new0 3!
OpenApiSecurityScheme4 I
{ 
Description 
= 
$str T
,T U
Name 
= 
$str &
,& '
Scheme 
= 
$str !
,! "
BearerFormat 
= 
$str $
,$ %
In   
=   
ParameterLocation   &
.  & '
Header  ' -
,  - .
Type!! 
=!! 
SecuritySchemeType!! )
.!!) *
Http!!* .
,!!. /
}"" 
)"" 
;"" 
c$$ 
.$$ "
AddSecurityRequirement$$ $
($$$ %
new$$% (&
OpenApiSecurityRequirement$$) C
{%% 
{&& 
new'' !
OpenApiSecurityScheme'' -
{(( 
	Reference)) !
=))" #
new))$ '
OpenApiReference))( 8
{** 
Type++  
=++! "
ReferenceType++# 0
.++0 1
SecurityScheme++1 ?
,++? @
Id,, 
=,,  
$str,,! +
}-- 
}.. 
,.. 
new// 
string// 
[// 
]//  
{//! "
}//" #
}00 
}11 
)11 
;11 
}22 	
)22	 

;22
 
return44 
services44 
;44 
}55 
public77 

static77 
IApplicationBuilder77 %
UseSwaggerConfig77& 6
(776 7
this777 ;
IApplicationBuilder77< O
app77P S
)77S T
{88 
app:: 
.:: 

UseSwagger:: 
(:: 
):: 
;:: 
app;; 
.;; 
UseSwaggerUI;; 
(;; 
);; 
;;; 
return<< 
app<< 
;<< 
}== 
}>> 
public@@ 
class@@  
SwaggerDefaultValues@@ !
:@@" #
IOperationFilter@@$ 4
{AA 
publicBB 

voidBB 
ApplyBB 
(BB 
OpenApiOperationBB &
	operationBB' 0
,BB0 1"
OperationFilterContextBB2 H
contextBBI P
)BBP Q
{CC 
ifDD 

(DD 
	operationDD 
.DD 

ParametersDD  
==DD! #
nullDD$ (
)DD( )
{EE 	
returnFF 
;FF 
}GG 	
foreachII 
(II 
varII 
	parameterII 
inII !
	operationII" +
.II+ ,

ParametersII, 6
)II6 7
{JJ 	
varKK 
descriptionKK 
=KK 
contextKK %
.KK% &
ApiDescriptionKK& 4
.LL !
ParameterDescriptionsLL &
.MM 
FirstMM 
(MM 
pMM 
=>MM 
pMM 
.MM 
NameMM "
==MM# %
	parameterMM& /
.MM/ 0
NameMM0 4
)MM4 5
;MM5 6
varOO 
	routeInfoOO 
=OO 
descriptionOO '
.OO' (
	RouteInfoOO( 1
;OO1 2
	operationQQ 
.QQ 

DeprecatedQQ  
=QQ! "
OpenApiOperationQQ# 3
.QQ3 4
DeprecatedDefaultQQ4 E
;QQE F
ifSS 
(SS 
	parameterSS 
.SS 
DescriptionSS %
==SS& (
nullSS) -
)SS- .
{TT 
	parameterUU 
.UU 
DescriptionUU %
=UU& '
descriptionUU( 3
.UU3 4
ModelMetadataUU4 A
?UUA B
.UUB C
DescriptionUUC N
;UUN O
}VV 
ifXX 
(XX 
	routeInfoXX 
==XX 
nullXX !
)XX! "
{YY 
continueZZ 
;ZZ 
}[[ 
if]] 
(]] 
	parameter]] 
.]] 
In]] 
!=]] 
ParameterLocation]]  1
.]]1 2
Path]]2 6
&&]]7 9
	parameter]]: C
.]]C D
Schema]]D J
.]]J K
Default]]K R
==]]S U
null]]V Z
)]]Z [
{^^ 
	parameter__ 
.__ 
Schema__  
.__  !
Default__! (
=__) *
new__+ .
OpenApiString__/ <
(__< =
	routeInfo__= F
.__F G
DefaultValue__G S
.__S T
ToString__T \
(__\ ]
)__] ^
)__^ _
;___ `
}`` 
	parameterbb 
.bb 
Requiredbb 
|=bb !
!bb" #
	routeInfobb# ,
.bb, -

IsOptionalbb- 7
;bb7 8
}cc 	
}dd 
}ee 
publicgg 
classgg '
SwaggerAuthorizedMiddlewaregg (
{hh 
privateii 
readonlyii 
RequestDelegateii $
_nextii% *
;ii* +
publickk 
'
SwaggerAuthorizedMiddlewarekk &
(kk& '
RequestDelegatekk' 6
nextkk7 ;
)kk; <
{ll 
_nextmm 
=mm 
nextmm 
;mm 
}nn 
publicpp 

asyncpp 
Taskpp 
Invokepp 
(pp 
HttpContextpp (
contextpp) 0
)pp0 1
{qq 
ifrr 

(rr 
contextrr 
.rr 
Requestrr 
.rr 
Pathrr  
.rr  !
StartsWithSegmentsrr! 3
(rr3 4
$strrr4 >
)rr> ?
&&ss 
!ss 
contextss 
.ss 
Userss 
.ss 
Identityss %
.ss% &
IsAuthenticatedss& 5
)ss5 6
{tt 	
contextuu 
.uu 
Responseuu 
.uu 

StatusCodeuu '
=uu( )
StatusCodesuu* 5
.uu5 6!
Status401Unauthorizeduu6 K
;uuK L
returnvv 
;vv 
}ww 	
awaityy 
_nextyy 
.yy 
Invokeyy 
(yy 
contextyy "
)yy" #
;yy# $
}zz 
}{{ ‹
_D:\TI\git\v2\e-Estoque-API\e-Estoque-API\e-Estoque-API.API\Configuration\ObservabilityConfig.cs
	namespace 	
e_Estoque_API
 
. 
API 
. 
Configuration )
;) *
public 
static 
class 
ObservabilityConfig '
{ 
public		 

static		 
IServiceCollection		 $
AddObservability		% 5
(		5 6
this		6 :
IServiceCollection		; M
services		N V
,		V W
string		X ^
serviceName		_ j
,		j k
IConfiguration		l z
configuration			{ ˆ
)
		ˆ ‰
{

 
var 
resource 
= 
ResourceBuilder &
.& '
CreateDefault' 4
(4 5
)5 6
.6 7

AddService7 A
(A B
serviceNameB M
:M N
serviceNameO Z
,Z [
serviceVersion\ j
:j k
$strl q
)q r
;r s
var 
otelBuilder 
= 
services "
." #
AddOpenTelemetry# 3
(3 4
)4 5
;5 6
otelBuilder 
. 
WithMetrics 
( 
metrics  
=>! #
{ 
metrics 
. 
SetResourceBuilder %
(% &
resource& .
). /
. %
AddRuntimeInstrumentation ,
(, -
)- .
. (
AddAspNetCoreInstrumentation /
(/ 0
)0 1
. (
AddHttpClientInstrumentation /
(/ 0
)0 1
. +
AddEventCountersInstrumentation 2
(2 3
c3 4
=>5 7
{ 
c 
. 
AddEventSources -
(- .
$str :
,: ;
$str A
,A B
$str -
,- .
$str   0
)  0 1
;  1 2
}!! 
)!! 
."" 
AddMeter"" 
("" 
$str"" :
,"": ;
$str""< a
)""a b
.## !
AddPrometheusExporter## (
(##( )
)##) *
;##* +
}$$ 
)$$ 
.&& 
WithTracing&& 
(&& 
tracing&&  
=>&&! #
{'' 
tracing(( 
.(( 
SetResourceBuilder(( *
(((* +
resource((+ 3
)((3 4
.)) (
AddAspNetCoreInstrumentation)) 1
())1 2
)))2 3
.** (
AddHttpClientInstrumentation** 1
(**1 2
)**2 3
.++ '
AddSqlClientInstrumentation++ 0
(++0 1
)++1 2
;++2 3
},, 
),, 
;,, 
return.. 
services.. 
;.. 
}// 
public11 

static11 
void11 
MapObservability11 '
(11' (
this11( ,!
IEndpointRouteBuilder11- B
routes11C I
)11I J
{22 
routes33 
.33 )
MapPrometheusScrapingEndpoint33 ,
(33, -
)33- .
;33. /
}44 
}55 ã

^D:\TI\git\v2\e-Estoque-API\e-Estoque-API\e-Estoque-API.API\Configuration\MiniProfilerConfig.cs
	namespace 	
e_Estoque_API
 
. 
API 
. 
Configuration )
;) *
public 
static 
class 
MiniProfilerConfig &
{ 
public 

static 
IServiceCollection $!
AddMiniProfilerConfig% :
(: ;
this; ?
IServiceCollection@ R
servicesS [
)[ \
{ 
services 
. 
AddMiniProfiler  
(  !
options! (
=>) +
{ 	
options		 
.		 
RouteBasePath		 !
=		" #
$str		$ /
;		/ 0
options

 
.

 
PopupRenderPosition

 '
=

( )
StackExchange

* 7
.

7 8
	Profiling

8 A
.

A B
RenderPosition

B P
.

P Q

BottomLeft

Q [
;

[ \
options 
. %
PopupShowTimeWithChildren -
=. /
true0 4
;4 5
} 	
)	 

.
 
AddEntityFramework 
( 
) 
;  
return 
services 
; 
} 
} ô:
ZD:\TI\git\v2\e-Estoque-API\e-Estoque-API\e-Estoque-API.API\Configuration\KeycloakConfig.cs
	namespace 	
e_Estoque_API
 
. 
API 
. 
Configuration )
;) *
public 
static 
class 
KeycloakConfig "
{ 
public		 

static		 
IServiceCollection		 $
AddKeycloakConfig		% 6
(		6 7
this		7 ;
IServiceCollection		< N
services		O W
,		W X
IConfiguration		Y g
configuration		h u
)		u v
{

 
var !
authenticationOptions !
=" #
configuration$ 1
. 

GetSection #
(# $)
KeycloakAuthenticationOptions$ A
.A B
SectionB I
)I J
. 
Get 
< )
KeycloakAuthenticationOptions :
>: ;
(; <
)< =
;= >
var 
keycloakSection 
= 
configuration +
.+ ,

GetSection, 6
(6 7
$str7 A
)A B
;B C
var 
keycloak 
= 
GetKeycloak "
(" #
keycloakSection# 2
)2 3
;3 4
services 
. 
AddSingleton 
( 
keycloak &
)& '
;' (
services 
. %
AddKeycloakAuthentication *
(* +!
authenticationOptions+ @
)@ A
;A B
var  
authorizationOptions  
=! "
configuration# 0
. 

GetSection #
(# $+
KeycloakProtectionClientOptions$ C
.C D
SectionD K
)K L
. 
Get 
< +
KeycloakProtectionClientOptions <
>< =
(= >
)> ?
;? @
services 
. $
AddKeycloakAuthorization )
() * 
authorizationOptions* >
)> ?
;? @
var 
adminClientOptions 
=  
configuration! .
. 

GetSection #
(# $&
KeycloakAdminClientOptions$ >
.> ?
Section? F
)F G
. 
Get 
< &
KeycloakAdminClientOptions 7
>7 8
(8 9
)9 :
;: ;
services   
.   &
AddKeycloakAdminHttpClient   +
(  + ,
adminClientOptions  , >
)  > ?
;  ? @
return"" 
services"" 
;"" 
}## 
private%% 
static%% 
Core%% 
.%% 
Models%% 
.%% 
Keycloak%% '
GetKeycloak%%( 3
(%%3 4!
IConfigurationSection%%4 I
keycloakSection%%J Y
)%%Y Z
{&& 
var'' 
keycloak'' 
='' 
new'' 
e_Estoque_API'' (
.''( )
Core'') -
.''- .
Models''. 4
.''4 5
Keycloak''5 =
(''= >
)''> ?
{(( 	
Realm)) 
=)) 
keycloakSection)) #
[))# $
$str))$ +
]))+ ,
??))- /
$str))0 2
,))2 3
AuthServerUrl** 
=** 
keycloakSection** +
[**+ ,
$str**, =
]**= >
??**? A
$str**B D
,**D E
SslRequired++ 
=++ 
keycloakSection++ )
[++) *
$str++* 8
]++8 9
??++: <
$str++= ?
,++? @
Resource,, 
=,, 
keycloakSection,, &
[,,& '
$str,,' 1
],,1 2
??,,3 5
$str,,6 8
,,,8 9
VerifyTokenAudience-- 
=--  !
keycloakSection--" 1
[--1 2
$str--2 I
]--I J
??--K M
$str--N P
,--P Q
Credentials.. 
=.. 
new.. 
e_Estoque_API.. +
...+ ,
Core.., 0
...0 1
Models..1 7
...7 8
Credentials..8 C
(..C D
)..D E
{// 
Secret00 
=00 
keycloakSection00 (
[00( )
$str00) =
]00= >
??00? A
$str00B D
,00D E
}11 
,11 
ConfidentialPort22 
=22 
keycloakSection22 .
[22. /
$str22/ B
]22B C
??22D F
$str22G I
}33 	
;33	 

ValidateKeys55 
(55 
keycloak55 
)55 
;55 
return77 
keycloak77 
;77 
}88 
private:: 
static:: 
void:: 
ValidateKeys:: $
(::$ %
Core::% )
.::) *
Models::* 0
.::0 1
Keycloak::1 9
keycloak::: B
)::B C
{;; 
if<< 

(<< 
string<< 
.<< 
IsNullOrEmpty<<  
(<<  !
keycloak<<! )
.<<) *
Realm<<* /
)<</ 0
)<<0 1
throw== 
new== 
ArgumentException== '
(==' (
$str==( D
)==D E
;==E F
if>> 

(>> 
string>> 
.>> 
IsNullOrEmpty>>  
(>>  !
keycloak>>! )
.>>) *
AuthServerUrl>>* 7
)>>7 8
)>>8 9
throw?? 
new?? 
ArgumentException?? '
(??' (
$str??( L
)??L M
;??M N
if@@ 

(@@ 
string@@ 
.@@ 
IsNullOrEmpty@@  
(@@  !
keycloak@@! )
.@@) *
SslRequired@@* 5
)@@5 6
)@@6 7
throwAA 
newAA 
ArgumentExceptionAA '
(AA' (
$strAA( J
)AAJ K
;AAK L
ifBB 

(BB 
stringBB 
.BB 
IsNullOrEmptyBB  
(BB  !
keycloakBB! )
.BB) *
ResourceBB* 2
)BB2 3
)BB3 4
throwCC 
newCC 
ArgumentExceptionCC '
(CC' (
$strCC( G
)CCG H
;CCH I
ifDD 

(DD 
stringDD 
.DD 
IsNullOrEmptyDD  
(DD  !
keycloakDD! )
.DD) *
VerifyTokenAudienceDD* =
)DD= >
)DD> ?
throwEE 
newEE 
ArgumentExceptionEE '
(EE' (
$strEE( R
)EER S
;EES T
ifFF 

(FF 
stringFF 
.FF 
IsNullOrEmptyFF  
(FF  !
keycloakFF! )
.FF) *
CredentialsFF* 5
.FF5 6
SecretFF6 <
)FF< =
)FF= >
throwGG 
newGG 
ArgumentExceptionGG '
(GG' (
$strGG( Q
)GGQ R
;GGR S
ifHH 

(HH 
stringHH 
.HH 
IsNullOrEmptyHH  
(HH  !
keycloakHH! )
.HH) *
ConfidentialPortHH* :
)HH: ;
)HH; <
throwII 
newII 
ArgumentExceptionII '
(II' (
$strII( O
)IIO P
;IIP Q
}JJ 
}KK Ö
VD:\TI\git\v2\e-Estoque-API\e-Estoque-API\e-Estoque-API.API\Configuration\CorsConfig.cs
	namespace 	
e_Estoque_API
 
. 
API 
. 
Configuration )
;) *
public 
static 
class 

CorsConfig 
{ 
public 

static 
IServiceCollection $
AddCorsConfig% 2
(2 3
this3 7
IServiceCollection8 J
servicesK S
)S T
{ 
services 
. 
AddCors 
( 
options  
=>! #
{ 	
options		 
.		 
	AddPolicy		 
(		 
$str		 +
,		+ ,
builder

 
=>

 
builder 
. 
AllowAnyOrigin #
(# $
)$ %
. 
AllowAnyMethod #
(# $
)$ %
. 
AllowAnyHeader #
(# $
)$ %
)% &
;& '
options 
. 
	AddPolicy 
( 
$str *
,* +
builder 
=> 
builder 
. 
WithMethods $
($ %
$str% *
)* +
. 
WithOrigins $
($ %
$str% 9
)9 :
. 7
+SetIsOriginAllowedToAllowWildcardSubdomains D
(D E
)E F
. 
AllowAnyHeader '
(' (
)( )
)) *
;* +
} 	
)	 

;
 
return 
services 
; 
} 
} 